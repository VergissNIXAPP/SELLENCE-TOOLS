/* SELLENCE-TOURENPLANER (SAP) */
:root{
  --bg0:#070A12; --bg1:#0B0F1D;
  --card: rgba(255,255,255,.06);
  --stroke: rgba(255,255,255,.12);
  --text: rgba(255,255,255,.92);
  --muted: rgba(255,255,255,.62);
  --purple:#5B2EFF; --blue:#1E8BFF; --mint:#31E7A6; --red:#FF4D6D; --amber:#FFD250;
  --shadow: 0 12px 40px rgba(0,0,0,.45);
  --radius: 20px;
}
*{box-sizing:border-box;}
html,body{height:100%;}
body{
  margin:0;
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
  color:var(--text);
  background:
    radial-gradient(1200px 700px at 25% -10%, rgba(91,46,255,.35), transparent 55%),
    radial-gradient(1000px 650px at 110% 20%, rgba(30,139,255,.28), transparent 60%),
    radial-gradient(800px 700px at 65% 115%, rgba(49,231,166,.14), transparent 60%),
    linear-gradient(180deg, var(--bg0), var(--bg1));
}
.bg-orb{position:fixed;width:520px;height:520px;filter:blur(42px);opacity:.22;pointer-events:none;border-radius:999px;mix-blend-mode:screen;}
.orb1{left:-140px;top:90px;background:radial-gradient(circle at 30% 30%, var(--purple), transparent 60%);}
.orb2{right:-170px;top:-120px;background:radial-gradient(circle at 30% 30%, var(--blue), transparent 62%);}
.orb3{left:50%;top:72%;transform:translateX(-50%);background:radial-gradient(circle at 30% 30%, var(--mint), transparent 62%);}

.topbar{
  position:sticky;top:0;z-index:10;
  /* iPhone WebApp: keep controls reachable by placing the bar lower */
  padding: calc(env(safe-area-inset-top, 0px) + 18px) 16px 14px;
  display:flex;align-items:center;justify-content:space-between;gap:12px;
  backdrop-filter:blur(14px);-webkit-backdrop-filter:blur(14px);
  background:linear-gradient(180deg, rgba(10,12,22,.86), rgba(10,12,22,.56));
  border-bottom:1px solid rgba(255,255,255,.08);
}
.brand{display:flex;gap:12px;align-items:center;}
.brand-mark{
  width:44px;height:44px;border-radius:14px;
  background:linear-gradient(135deg, rgba(91,46,255,.95), rgba(30,139,255,.92));
  box-shadow:0 14px 34px rgba(91,46,255,.25);
  display:grid;place-items:center;
  border:1px solid rgba(255,255,255,.14);
}
.brand-mark svg{width:34px;height:34px;}
.brand-title{font-weight:950;letter-spacing:.10em;font-size:14px;line-height:1.1;}
.brand-sub{font-weight:800;letter-spacing:.12em;font-size:11px;color:rgba(255,255,255,.72);text-transform:uppercase;}
.top-actions{display:flex;gap:10px;align-items:center;flex-wrap:wrap;}

.shell{padding:14px 14px 28px;max-width:1280px;margin:0 auto;}
.grid{display:grid;gap:14px;}
@media(min-width:980px){.grid.two{grid-template-columns:1.2fr .8fr;}}
.card{
  border-radius:var(--radius);
  border:1px solid rgba(255,255,255,.10);
  background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.04));
  box-shadow:var(--shadow);
  padding:14px;
}
.card-h{display:flex;align-items:flex-start;justify-content:space-between;gap:12px;margin-bottom:10px;}
h2{margin:0;font-size:16px;letter-spacing:.02em;}
.muted{color:var(--muted);}
.tiny{font-size:12px;}
.pill{min-width:44px;padding:6px 10px;border-radius:999px;border:1px solid rgba(255,255,255,.12);background:rgba(255,255,255,.06);text-align:center;font-weight:900;}

.row{display:flex;gap:10px;flex-wrap:wrap;align-items:flex-end;}
.field{display:flex;flex-direction:column;gap:6px;flex:1;min-width:180px;}
.field span{font-size:12px;color:rgba(255,255,255,.70);font-weight:900;letter-spacing:.02em;}
input{
  appearance:none;width:100%;
  padding:12px 12px;border-radius:14px;
  border:1px solid rgba(255,255,255,.12);
  background:rgba(0,0,0,.22);
  color:rgba(255,255,255,.92);
  outline:none;
}
input::placeholder{color:rgba(255,255,255,.42);}
input:focus{border-color:rgba(91,46,255,.55);box-shadow:0 0 0 4px rgba(91,46,255,.18);}

.btn{
  border-radius:14px;border:1px solid rgba(255,255,255,.14);
  background:rgba(255,255,255,.06);color:rgba(255,255,255,.92);
  padding:11px 12px;font-weight:900;letter-spacing:.02em;
  cursor:pointer;display:inline-flex;align-items:center;justify-content:center;gap:8px;user-select:none;
}
.btn:hover{border-color:rgba(255,255,255,.22);background:rgba(255,255,255,.08);}
.btn:active{transform:translateY(1px);}
.btn.primary{
  border-color:rgba(255,255,255,.18);
  background:linear-gradient(135deg, rgba(91,46,255,.95), rgba(30,139,255,.92));
  box-shadow:0 14px 30px rgba(91,46,255,.22);
}
.btn.danger{border-color:rgba(255,77,109,.40);background:rgba(255,77,109,.10);}
.btn:disabled{opacity:.45;cursor:not-allowed;transform:none;}

.map{
  width:100%;
  height: clamp(420px, 70vh, 760px);
  border-radius: 18px;
  border:1px solid rgba(255,255,255,.10);
  overflow:hidden;
  box-shadow: 0 18px 50px rgba(0,0,0,.35);
}
.leaflet-container{background:rgba(0,0,0,.12);}

.list{margin-top:12px;display:flex;flex-direction:column;gap:10px;max-height:65vh;overflow:auto;padding-right:4px;}
.item{
  border-radius:18px;border:1px solid rgba(255,255,255,.10);
  background:rgba(0,0,0,.18);
  padding:12px;display:flex;align-items:flex-start;justify-content:space-between;gap:12px;
}
.item .meta{display:flex;flex-direction:column;gap:4px;}
.item .title{font-weight:950;letter-spacing:.01em;}
.item .sub{color:var(--muted);font-size:12px;}
.badges{display:flex;gap:6px;flex-wrap:wrap;margin-top:2px;}
.badge{font-size:11px;padding:3px 8px;border-radius:999px;border:1px solid rgba(255,255,255,.12);background:rgba(255,255,255,.05);color:rgba(255,255,255,.76);}
.badge.ok{border-color:rgba(49,231,166,.35);background:rgba(49,231,166,.10);}
.badge.warn{border-color:rgba(255,210,80,.35);background:rgba(255,210,80,.10);}
.actions-mini{display:flex;gap:8px;flex-wrap:wrap;justify-content:flex-end;}

.hr{height:1px;background:rgba(255,255,255,.08);margin:12px 0;}
.kpi{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:10px;}
.kpi .box{border-radius:18px;border:1px solid rgba(255,255,255,.10);background:rgba(0,0,0,.18);padding:10px 12px;}
.kpi .v{font-weight:950;font-size:18px;margin-top:4px;}

/* Return-to-start checkbox */
.check{display:flex;align-items:center;gap:10px;font-size:14px;color:rgba(255,255,255,.82);user-select:none;}
.check input{position:absolute;opacity:0;pointer-events:none;width:1px;height:1px;}
.checkDot{width:18px;height:18px;border-radius:999px;background:rgba(255,255,255,.14);border:1px solid rgba(255,255,255,.22);display:inline-flex;align-items:center;justify-content:center;flex:0 0 18px;}
.checkDot::after{content:"";font-size:13px;line-height:1;font-weight:900;opacity:0;transform:translateY(-0.5px);}
.check input:checked + .checkDot{background:#5B2EFF;border-color:rgba(255,255,255,.28);box-shadow:0 0 0 3px rgba(91,46,255,.18);}
.check input:checked + .checkDot::after{content:"✕";opacity:1;}
.checkText{line-height:1.2;}

/* Modal (Add Market) */
.modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;padding:16px;background:rgba(0,0,0,.45);backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);z-index:9999;}
.modal.open{display:flex;}
.modalCard{width:min(560px, 100%);border-radius:22px;background:rgba(18,28,64,.92);border:1px solid rgba(255,255,255,.12);box-shadow:0 22px 80px rgba(0,0,0,.45);padding:14px;}
.modalHead{display:flex;align-items:flex-start;justify-content:space-between;gap:12px;padding:6px 4px 10px;}
.modalTitle{font-size:18px;font-weight:800;letter-spacing:.02em;}
.modalBody{display:flex;flex-direction:column;gap:10px;padding:6px 2px 8px;}
.modalActions{display:flex;gap:10px;justify-content:flex-end;padding:8px 2px 2px;}

@media (max-width:420px){
  .modalCard{border-radius:18px;}
  .modalActions{flex-direction:column;}
  .modalActions .btn{width:100%;}
}
.note{border-radius:18px;border:1px dashed rgba(255,255,255,.16);background:rgba(0,0,0,.12);padding:10px 12px;color:rgba(255,255,255,.75);font-size:12px;}

.status{margin-top:10px;min-height:18px;font-size:13px;line-height:1.3;color:rgba(255,255,255,.78);opacity:0;transform:translateY(-2px);transition:opacity .15s ease, transform .15s ease;}
.status.show{opacity:1;transform:translateY(0);}

.how{display:flex;flex-direction:column;gap:10px;}
.how-panel{animation:fadeIn .16s ease-out;}
@keyframes fadeIn{from{opacity:0;transform:translateY(-2px);}to{opacity:1;transform:translateY(0);}}

/* Leaflet popup – match SELLENCE dark style */
.leaflet-popup-content-wrapper,
.leaflet-popup-tip{
  background: linear-gradient(180deg, rgba(10,12,22,.92), rgba(10,12,22,.78));
  color: rgba(255,255,255,.92);
  border: 1px solid rgba(255,255,255,.14);
  box-shadow: 0 22px 60px rgba(0,0,0,.55);
}
.leaflet-popup-content{margin:12px 14px;}
.popupTitle{font-weight:950;letter-spacing:.01em;margin-bottom:4px;}
.popupAddr{font-size:12px;color:rgba(255,255,255,.72);margin-bottom:8px;}
.popupMeta{font-size:12px;color:rgba(255,255,255,.72);margin-bottom:10px;}
.popupActions{display:flex;gap:8px;flex-wrap:wrap;}

/* Back button (integrated into SELLENCE Tools) */
.backBtn{
  display:inline-flex; align-items:center; gap:10px;
  padding:10px 12px; border-radius:14px;
  border:1px solid rgba(255,255,255,.14);
  background:rgba(255,255,255,.06);
  color:rgba(255,255,255,.92);
  text-decoration:none;
  font-weight:900; letter-spacing:.02em;
}
.backBtn:hover{border-color:rgba(255,255,255,.22); background:rgba(255,255,255,.08);}
.backIcon{font-size:16px; line-height:1; opacity:.9;}


/* Top-right hamburger menu */
.top-actions{position:relative;}
.menu{
  position:absolute;
  top:52px;
  right:0;
  display:none;
  flex-direction:column;
  gap:8px;
  padding:10px;
  border-radius:18px;
  border:1px solid rgba(255,255,255,.12);
  background:linear-gradient(180deg, rgba(10,12,22,.92), rgba(10,12,22,.74));
  box-shadow: 0 18px 50px rgba(0,0,0,.45);
  min-width: 200px;
  z-index: 50;
  backdrop-filter: blur(14px);
  -webkit-backdrop-filter: blur(14px);
}
.menu.open{display:flex;}
@media (max-width:520px){
  .menu{left:0; right:auto; width: min(92vw, 320px);}
}

