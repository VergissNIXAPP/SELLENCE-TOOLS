<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <meta name="theme-color" content="#0A1022">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <title>SELLENCE Tools</title>

  <link rel="manifest" href="manifest.webmanifest">
  <link rel="icon" href="icon-192.png" sizes="192x192">
  <link rel="apple-touch-icon" href="icon-192.png">
  <link rel="stylesheet" href="tools.css">

  <style>
    /* small page-specific tweaks */
    .heroTitle{margin:0;font-size:clamp(22px,3.2vw,30px);font-weight:900;letter-spacing:-.01em;}
    .heroText{margin:8px 0 0;color:var(--muted);font-size:13px;line-height:1.45;}
    .topPad{padding:14px;}
    .footSplit{display:flex;gap:10px;justify-content:center;flex-wrap:wrap;}
    /* reorder mode */
    .tiles{position:relative;}
    .tile{position:relative;}
    .reorderCtrls{position:absolute;right:12px;top:12px;display:none;gap:6px;z-index:2;}
    body.reorderMode .reorderCtrls{display:flex;}
    .reBtn{width:34px;height:34px;border-radius:10px;border:1px solid rgba(255,255,255,.12);background:rgba(10,16,34,.65);color:#fff;display:grid;place-items:center;font-weight:900;}
    .reBtn:active{transform:scale(.98);}
  </style>
</head>
<body>
  <main class="container">
    <header class="header" role="banner">
      <div class="brandLine">SELLENCE</div>
      <div class="appLine">TOOLS</div>
        <p class="heroText">Digital - Einfach - Arbeiten</p>
    </header>

    <section class="card" aria-label="Tool Auswahl">
      <div class="topPad" style="text-align:center">
        <h1 class="heroTitle">Was mÃ¶chtest du starten?</h1>
      </div>

      <div class="tiles" id="tiles">
        <a class="tile" data-tool="touren" href="./touren/index.html" aria-label="Tourenplaner Ã¶ffnen">
          <div class="reorderCtrls" aria-hidden="true">
            <button class="reBtn" type="button" data-move="up" title="Nach oben">â–²</button>
            <button class="reBtn" type="button" data-move="down" title="Nach unten">â–¼</button>
          </div>
          <div class="thumb"><img src="assets/touren-icon.png" alt="Tourenplaner Icon"></div>
          <div class="meta">
            <div class="kicker">Google Maps Export</div>
            <p class="name">Tourenplaner</p>
            <p class="desc">Kundenliste importieren, SAP suchen, Stops sammeln & in Maps starten.</p>
          </div>
          <div class="go" aria-hidden="true">
            <svg viewBox="0 0 24 24"><path d="M13.2 5.3a1 1 0 0 1 1.4 0l6.4 6.4a1 1 0 0 1 0 1.4l-6.4 6.4a1 1 0 1 1-1.4-1.4l4.7-4.7H4a1 1 0 1 1 0-2h13.5l-4.7-4.7a1 1 0 0 1 0-1.4z"/></svg>
          </div>
        </a>

        <a class="tile" data-tool="stempeluhr" href="./stempeluhr/index.html" aria-label="Stempeluhr Ã¶ffnen">
          <div class="reorderCtrls" aria-hidden="true">
            <button class="reBtn" type="button" data-move="up" title="Nach oben">â–²</button>
            <button class="reBtn" type="button" data-move="down" title="Nach unten">â–¼</button>
          </div>
          <div class="thumb"><img src="assets/stempeluhr-icon.png" alt="Stempeluhr Icon"></div>
          <div class="meta">
            <div class="kicker">Arbeitszeit</div>
            <p class="name">Stempeluhr</p>
            <p class="desc">Ein- & Ausstempeln, Tagesliste, Netto-Stunden inkl. Pause und Excel/CSV Export.</p>
          </div>
          <div class="go" aria-hidden="true">
            <svg viewBox="0 0 24 24"><path d="M13.2 5.3a1 1 0 0 1 1.4 0l6.1 6.1a1 1 0 0 1 0 1.4l-6.1 6.1a1 1 0 1 1-1.4-1.4l4.4-4.4H4a1 1 0 1 1 0-2h13.6l-4.4-4.4a1 1 0 0 1 0-1.4z"/></svg>
          </div>
        </a>

        <a class="tile" data-tool="vwhelfer" href="./sellence-vw-helfer/index.html" aria-label="VW Helfer Ã¶ffnen">
          <div class="reorderCtrls" aria-hidden="true">
            <button class="reBtn" type="button" data-move="up" title="Nach oben">â–²</button>
            <button class="reBtn" type="button" data-move="down" title="Nach unten">â–¼</button>
          </div>
          <div class="thumb"><img src="sellence-vw-helfer/assets/vw-icon.png" alt="VW Helfer Icon"></div>
          <div class="meta">
            <div class="kicker">VW Â· Tipps & Tricks</div>
            <p class="name">VW Helfer</p>
            <p class="desc">Schnelle Hilfe: Funktionen, Shortcuts und kleine Alltags-Hacks.</p>
          </div>
          <div class="go" aria-hidden="true">
            <svg viewBox="0 0 24 24"><path d="M13.2 5.3a1 1 0 0 1 1.4 0l6.1 6.1a1 1 0 0 1 0 1.4l-6.1 6.1a1 1 0 1 1-1.4-1.4l4.4-4.4H4a1 1 0 1 1 0-2h13.6l-4.4-4.4a1 1 0 0 1 0-1.4z"/></svg>
          </div>
        </a>


        <a class="tile" data-tool="retouren" href="./retouren/index.html" aria-label="Retourenrechner Ã¶ffnen">
          <div class="reorderCtrls" aria-hidden="true">
            <button class="reBtn" type="button" data-move="up" title="Nach oben">â–²</button>
            <button class="reBtn" type="button" data-move="down" title="Nach unten">â–¼</button>
          </div>
          <div class="thumb"><img src="assets/retouren-icon.png" alt="Retourenrechner Icon"></div>
          <div class="meta">
            <div class="kicker">Retouren</div>
            <p class="name">Retourenrechner</p>
            <p class="desc">Packs, Preise & Summen â€“ sauber und schnell berechnet inkl. Ãœbersicht.</p>
          </div>
          <div class="go" aria-hidden="true">
            <svg viewBox="0 0 24 24"><path d="M13.2 5.3a1 1 0 0 1 1.4 0l6.1 6.1a1 1 0 0 1 0 1.4l-6.1 6.1a1 1 0 1 1-1.4-1.4l4.4-4.4H4a1 1 0 1 1 0-2h13.6l-4.4-4.4a1 1 0 0 1 0-1.4z"/></svg>
          </div>
        </a>

        <a class="tile" data-tool="oos" href="./oos/index.html" aria-label="OOS Scanner Ã¶ffnen">
          <div class="reorderCtrls" aria-hidden="true">
            <button class="reBtn" type="button" data-move="up" title="Nach oben">â–²</button>
            <button class="reBtn" type="button" data-move="down" title="Nach unten">â–¼</button>
          </div>
          <div class="thumb"><img src="assets/oos-icon.png" alt="OOS Scanner Icon"></div>
          <div class="meta">
            <div class="kicker">Out of Stock</div>
            <p class="name">OOS Scanner</p>
            <p class="desc">Screenshot auswÃ¤hlen, EANs erkennen und OOS schnell dokumentieren.</p>
          </div>
          <div class="go" aria-hidden="true">
            <svg viewBox="0 0 24 24"><path d="M13.2 5.3a1 1 0 0 1 1.4 0l6.1 6.1a1 1 0 0 1 0 1.4l-6.1 6.1a1 1 0 1 1-1.4-1.4l4.4-4.4H4a1 1 0 1 1 0-2h13.6l-4.4-4.4a1 1 0 0 1 0-1.4z"/></svg>
          </div>
        </a>
        <a class="tile tile--soon" data-tool="lagerbestand" href="#" aria-label="SELLENCE Lagerbestand (bald verfÃ¼gbar)">
          <div class="reorderCtrls" aria-hidden="true">
            <button class="reBtn" type="button" data-move="up" title="Nach oben">â–²</button>
            <button class="reBtn" type="button" data-move="down" title="Nach unten">â–¼</button>
          </div>
          <div class="thumb" aria-hidden="true">
            <svg viewBox="0 0 64 64" role="img" aria-label="">
              <path d="M10 20l22-10 22 10-22 10-22-10zm0 8l22 10 22-10v8L32 46 10 36v-8zm0 16l22 10 22-10v6L32 60 10 50v-6z"/>
            </svg>
          </div>
          <div class="meta">
            <div class="kicker kicker--soon">Bald verfÃ¼gbar</div>
            <p class="name">Lagerbestand</p>
            <p class="desc">PMG-Bestellung als Screenshot hochladen â†’ Alles im Lagerbestand âœ…</p>
          </div>
          <div class="go" aria-hidden="true">
            <svg viewBox="0 0 24 24"><path d="M13.2 5.3a1 1 0 0 1 1.4 0l6.1 6.1a1 1 0 0 1 0 1.4l-6.1 6.1a1 1 0 1 1-1.4-1.4l4.7-4.7H4a1 1 0 1 1 0-2h13.5l-4.7-4.7a1 1 0 0 1 0-1.4z"/></svg>
          </div>
        </a>
        <a class="tile" data-tool="mto" href="./mto/index.html" aria-label="MTO Rechner Ã¶ffnen">
          <div class="reorderCtrls" aria-hidden="true">
            <button class="reBtn" type="button" data-move="up" title="Nach oben">â–²</button>
            <button class="reBtn" type="button" data-move="down" title="Nach unten">â–¼</button>
          </div>
          <div class="thumb"><img src="assets/mto-icon.png" alt="MTO Rechner Icon"></div>
          <div class="meta">
            <div class="kicker">MTO</div>
            <p class="name">MTO Rechner</p>
            <p class="desc">Schnell berechnen und dokumentieren â€“ Ã¼bersichtlich & sofort einsatzbereit.</p>
          </div>
          <div class="go" aria-hidden="true">
            <svg viewBox="0 0 24 24"><path d="M13.2 5.3a1 1 0 0 1 1.4 0l6.1 6.1a1 1 0 0 1 0 1.4l-6.1 6.1a1 1 0 1 1-1.4-1.4l4.4-4.4H4a1 1 0 1 1 0-2h13.6l-4.4-4.4a1 1 0 0 1 0-1.4z"/></svg>
          </div>
        </a>

        <a class="tile" data-tool="picos" href="./picos-pos/index.html" aria-label="PICOS POS Rechner Ã¶ffnen">
          <div class="reorderCtrls" aria-hidden="true">
            <button class="reBtn" type="button" data-move="up" title="Nach oben">â–²</button>
            <button class="reBtn" type="button" data-move="down" title="Nach unten">â–¼</button>
          </div>
          <div class="thumb"><img src="assets/picos-icon.png" alt="PICOS POS Rechner Icon"></div>
          <div class="meta">
            <div class="kicker">PICOS Â· POS</div>
            <p class="name">PICOS POS Rechner</p>
            <p class="desc">Produkte eingeben und direkt ausrechnen â€“ ideal fÃ¼r schnelle Kalkulationen unterwegs.</p>
          </div>
          <div class="go" aria-hidden="true">
            <svg viewBox="0 0 24 24"><path d="M13.2 5.3a1 1 0 0 1 1.4 0l6.1 6.1a1 1 0 0 1 0 1.4l-6.1 6.1a1 1 0 1 1-1.4-1.4l4.4-4.4H4a1 1 0 1 1 0-2h13.6l-4.4-4.4a1 1 0 0 1 0-1.4z"/></svg>
          </div>
        </a>


      </div>

      <div class="footerRow">
        <div class="footSplit">
          <span class="chip">Login: einmalig Â· Passcode: <b>sellence</b></span>
          <button class="linkBtn" id="reorderBtn" type="button">Reihenfolge Ã¤ndern</button>
          <button class="linkBtn" id="logout" type="button">Logout</button>
        </div>
      </div>
    </section>
  </main>

  <!-- Login Overlay -->
  <div class="overlay" id="overlay" role="dialog" aria-modal="true" aria-label="Passcode Dialog">
    <div class="sheet">
      <div class="sheetHead">
        <div class="brandLine">SELLENCE</div>
        <div class="appLine">PASSCODE</div>
        <div class="sub">Bitte einmal eingeben. Danach bleibt dieses GerÃ¤t angemeldet.</div>
      </div>
      <div class="sheetBody">
        <label class="label" for="pass">Passcode</label>
        <div class="inputRow">
          <input id="pass" type="password" inputmode="text" autocomplete="current-password" placeholder="Passcode eingeben">
          <button class="primaryBtn" id="goBtn" type="button">Anmelden</button>
        </div>
        <div class="err" id="err">Falscher Passcode.</div>
        <button class="ghostBtn" id="clearBtn" type="button">Login zurÃ¼cksetzen</button>
        <div class="small">Hinweis: Login wird im Browser (localStorage) gespeichert.</div>
      </div>
    </div>
  </div>

  <script>
    const AUTH_KEY="sellence_auth";
    const PASSCODE="sellence";

    const overlay=document.getElementById("overlay");
    const passEl=document.getElementById("pass");
    const errEl=document.getElementById("err");
    const goBtn=document.getElementById("goBtn");
    const logout=document.getElementById("logout");
    const reorderBtn=document.getElementById("reorderBtn");
    const clearBtn=document.getElementById("clearBtn");

    // ---- Tool order (per-device, localStorage) ----
    const ORDER_KEY = "sellence_tools_order";
    const tilesWrap = document.getElementById("tiles");
    const tileEls = ()=>Array.from(tilesWrap?.querySelectorAll(".tile")||[]);

    function readOrder(){
      try{ return JSON.parse(localStorage.getItem(ORDER_KEY)||"[]") }catch{ return [] }
    }
    function writeOrder(ids){
      try{ localStorage.setItem(ORDER_KEY, JSON.stringify(ids)); }catch(e){}
    }
    function applyOrder(){
      if(!tilesWrap) return;

      const pinnedLast = ["mto","picos"];
      const baseDefault = ["touren","stempeluhr","vwhelfer","retouren","oos","lagerbestand"];

      let order = readOrder();

      if(!Array.isArray(order) || !order.length){
        order = [...baseDefault, ...pinnedLast];
      } else {
        const seen = new Set();
        const cleaned = [];
        for(const id of order){
          if(!id) continue;
          if(pinnedLast.includes(id)) continue; // always pinned to the bottom
          if(seen.has(id)) continue;
          cleaned.push(id);
          seen.add(id);
        }
        // ensure base tools exist (if user had an older saved order)
        for(const id of baseDefault){
          if(seen.has(id)) continue;

          // NEW tool: VW Helfer should default to position 3 (after Tourenplaner + Stempeluhr)
          if(id==="vwhelfer"){
            const idx = cleaned.indexOf("stempeluhr");
            if(idx>=0) cleaned.splice(idx+1, 0, id);
            else cleaned.push(id);
            seen.add(id);
            continue;
          }

          cleaned.push(id);
          seen.add(id);
        }
        order = [...cleaned, ...pinnedLast];
      }

      // persist (also fixes old saved orders automatically)
      writeOrder(order);

      const map = new Map(tileEls().map(el=>[el.dataset.tool, el]));
      // known ids first
      order.forEach(id=>{ const el=map.get(id); if(el) tilesWrap.appendChild(el); });
      // append any new tools not in saved order (but still keep pinnedLast last)
      const pinnedSet = new Set(pinnedLast);
      tileEls().forEach(el=>{
        if(pinnedSet.has(el.dataset.tool)) return;
        tilesWrap.appendChild(el);
      });
      pinnedLast.forEach(id=>{
        const el = map.get(id);
        if(el) tilesWrap.appendChild(el);
      });
    }
    function persistCurrentOrder(){
      const ids = tileEls().map(el=>el.dataset.tool).filter(Boolean);
      writeOrder(ids);
    }
    function setReorderMode(on){
      document.body.classList.toggle("reorderMode", !!on);
      reorderBtn.textContent = on ? "Fertig" : "Reihenfolge Ã¤ndern";
    }

    applyOrder();

    // placeholder tiles (coming soon)
    tilesWrap?.addEventListener("click", (e)=>{
      const a = e.target.closest?.("a.tile--soon");
      if(!a) return;
      if(document.body.classList.contains("reorderMode")) return;
      e.preventDefault();
      alert("Die SELLENCE Lagerbestand App ist bald verfÃ¼gbar ðŸ™‚");
    });


    // prevent navigation while reordering
    document.addEventListener("click", (e)=>{
      if(!document.body.classList.contains("reorderMode")) return;
      const a = e.target.closest?.("a.tile");
      if(a){ e.preventDefault(); }
    }, true);

    // reorder controls
    tilesWrap?.addEventListener("click", (e)=>{
      const btn = e.target.closest?.(".reBtn");
      if(!btn) return;
      e.preventDefault();
      e.stopPropagation();
      const tile = btn.closest(".tile");
      if(!tile) return;
      const dir = btn.dataset.move;
      const list = tileEls();
      const idx = list.indexOf(tile);
      if(dir==="up" && idx>0){ tilesWrap.insertBefore(tile, list[idx-1]); persistCurrentOrder(); }
      if(dir==="down" && idx>=0 && idx<list.length-1){ tilesWrap.insertBefore(list[idx+1], tile); persistCurrentOrder(); }
    });

    reorderBtn?.addEventListener("click", ()=>{
      setReorderMode(!document.body.classList.contains("reorderMode"));
    });

    function isAuthed(){try{return localStorage.getItem(AUTH_KEY)==="1"}catch(e){return false}}
    function setAuthed(){try{localStorage.setItem(AUTH_KEY,"1")}catch(e){}}
    function clearAuth(){try{localStorage.removeItem(AUTH_KEY)}catch(e){}}

    function showLogin(){overlay.classList.add("show");setTimeout(()=>passEl.focus(),50)}
    function hideLogin(){overlay.classList.remove("show");errEl.style.display="none";passEl.value="";}

    function attempt(){
      const v=(passEl.value||"").trim().toLowerCase();
      if(v===PASSCODE){setAuthed();hideLogin();}
      else{errEl.style.display="block";passEl.focus();passEl.select();navigator.vibrate?.(30)}
    }

    goBtn.addEventListener("click",attempt);
    passEl.addEventListener("keydown",(e)=>{if(e.key==="Enter") attempt();});
    logout.addEventListener("click",()=>{clearAuth();showLogin();});
    clearBtn.addEventListener("click",()=>{clearAuth();passEl.value="";errEl.style.display="none";passEl.focus();});

    if(!isAuthed()) showLogin();

    if("serviceWorker" in navigator){
      window.addEventListener("load",()=>navigator.serviceWorker.register("./sw.js").catch(()=>{}));
    }
  </script>
</body>
</html>
